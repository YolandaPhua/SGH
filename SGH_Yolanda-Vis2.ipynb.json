{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "conn=sqlite3.connect(\"SGH_Yolanda\") "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "c=conn.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "cur = conn.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "url2 = 'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018/2018-11-13/malaria_deaths_age.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "df2 = pd.read_csv(url2, error_bad_lines=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "df2= df2.pivot_table(values='deaths', index='year', columns=['entity', 'age_group'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity</th>\n",
       "      <th>Afghanistan</th>\n",
       "      <th>Albania</th>\n",
       "      <th>Algeria</th>\n",
       "      <th>American Samoa</th>\n",
       "      <th>Andean Latin America</th>\n",
       "      <th>Andorra</th>\n",
       "      <th>Angola</th>\n",
       "      <th>Antigua and Barbuda</th>\n",
       "      <th>Argentina</th>\n",
       "      <th>Armenia</th>\n",
       "      <th>...</th>\n",
       "      <th>Vanuatu</th>\n",
       "      <th>Venezuela</th>\n",
       "      <th>Vietnam</th>\n",
       "      <th>Wales</th>\n",
       "      <th>Western Europe</th>\n",
       "      <th>Western Sub-Saharan Africa</th>\n",
       "      <th>World</th>\n",
       "      <th>Yemen</th>\n",
       "      <th>Zambia</th>\n",
       "      <th>Zimbabwe</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>year</th>\n",
       "      <th>age_group</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1990</th>\n",
       "      <th>15-49</th>\n",
       "      <td>414.709676</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.499560</td>\n",
       "      <td>0.071837</td>\n",
       "      <td>40.859972</td>\n",
       "      <td>0.0</td>\n",
       "      <td>207.899777</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.065996</td>\n",
       "      <td>0.568197</td>\n",
       "      <td>...</td>\n",
       "      <td>24.294096</td>\n",
       "      <td>12.526649</td>\n",
       "      <td>494.239483</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11329.442132</td>\n",
       "      <td>48275.169475</td>\n",
       "      <td>2.340752</td>\n",
       "      <td>351.092094</td>\n",
       "      <td>146.071799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5-14</th>\n",
       "      <td>53.352844</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.124682</td>\n",
       "      <td>0.000602</td>\n",
       "      <td>26.399371</td>\n",
       "      <td>0.0</td>\n",
       "      <td>229.748378</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.184367</td>\n",
       "      <td>0.035616</td>\n",
       "      <td>...</td>\n",
       "      <td>2.169473</td>\n",
       "      <td>3.104614</td>\n",
       "      <td>114.558962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>22390.602195</td>\n",
       "      <td>68752.585590</td>\n",
       "      <td>0.105084</td>\n",
       "      <td>605.567382</td>\n",
       "      <td>72.520402</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50-69</th>\n",
       "      <td>60.541746</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.771225</td>\n",
       "      <td>0.026402</td>\n",
       "      <td>13.458133</td>\n",
       "      <td>0.0</td>\n",
       "      <td>125.521504</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.518110</td>\n",
       "      <td>0.273035</td>\n",
       "      <td>...</td>\n",
       "      <td>7.818126</td>\n",
       "      <td>3.858881</td>\n",
       "      <td>157.004672</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>9695.252559</td>\n",
       "      <td>27720.578684</td>\n",
       "      <td>0.436791</td>\n",
       "      <td>205.413588</td>\n",
       "      <td>40.454584</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70 or older</th>\n",
       "      <td>10.728850</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.329148</td>\n",
       "      <td>0.007296</td>\n",
       "      <td>8.512362</td>\n",
       "      <td>0.0</td>\n",
       "      <td>65.237773</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.329918</td>\n",
       "      <td>0.174232</td>\n",
       "      <td>...</td>\n",
       "      <td>2.034979</td>\n",
       "      <td>1.558702</td>\n",
       "      <td>75.116583</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6163.091793</td>\n",
       "      <td>15103.452338</td>\n",
       "      <td>0.148370</td>\n",
       "      <td>119.232947</td>\n",
       "      <td>24.646719</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Under 5</th>\n",
       "      <td>184.606435</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.633437</td>\n",
       "      <td>0.000942</td>\n",
       "      <td>43.893407</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2155.637127</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.152748</td>\n",
       "      <td>0.048349</td>\n",
       "      <td>...</td>\n",
       "      <td>50.577984</td>\n",
       "      <td>6.793810</td>\n",
       "      <td>241.306740</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>288512.048844</td>\n",
       "      <td>586161.122620</td>\n",
       "      <td>1.045693</td>\n",
       "      <td>6997.750038</td>\n",
       "      <td>260.447881</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">2016</th>\n",
       "      <th>15-49</th>\n",
       "      <td>1325.554673</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.119187</td>\n",
       "      <td>0.077682</td>\n",
       "      <td>10.556593</td>\n",
       "      <td>0.0</td>\n",
       "      <td>847.451177</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.994254</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>2.383817</td>\n",
       "      <td>10.920133</td>\n",
       "      <td>550.367934</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27308.825303</td>\n",
       "      <td>69181.523171</td>\n",
       "      <td>4.976979</td>\n",
       "      <td>605.018912</td>\n",
       "      <td>453.902190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5-14</th>\n",
       "      <td>186.455122</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.094867</td>\n",
       "      <td>0.000565</td>\n",
       "      <td>1.892259</td>\n",
       "      <td>0.0</td>\n",
       "      <td>574.935652</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.027874</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.016351</td>\n",
       "      <td>1.184906</td>\n",
       "      <td>48.886247</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>35949.278660</td>\n",
       "      <td>66900.805566</td>\n",
       "      <td>0.148588</td>\n",
       "      <td>443.313028</td>\n",
       "      <td>177.953936</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50-69</th>\n",
       "      <td>188.921260</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.726747</td>\n",
       "      <td>0.040865</td>\n",
       "      <td>5.722080</td>\n",
       "      <td>0.0</td>\n",
       "      <td>493.088315</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.625112</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>2.937429</td>\n",
       "      <td>3.779178</td>\n",
       "      <td>279.487378</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>17718.223791</td>\n",
       "      <td>40516.069944</td>\n",
       "      <td>1.048979</td>\n",
       "      <td>324.302931</td>\n",
       "      <td>97.402058</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70 or older</th>\n",
       "      <td>35.423502</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.790427</td>\n",
       "      <td>0.006043</td>\n",
       "      <td>4.174871</td>\n",
       "      <td>0.0</td>\n",
       "      <td>295.787678</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.764052</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.783829</td>\n",
       "      <td>1.737585</td>\n",
       "      <td>152.587626</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>12048.574328</td>\n",
       "      <td>26055.802074</td>\n",
       "      <td>0.292241</td>\n",
       "      <td>247.774196</td>\n",
       "      <td>66.572213</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Under 5</th>\n",
       "      <td>409.785603</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.284843</td>\n",
       "      <td>0.000471</td>\n",
       "      <td>3.682405</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5510.827146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.015501</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.021150</td>\n",
       "      <td>2.173018</td>\n",
       "      <td>96.689580</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>353171.602621</td>\n",
       "      <td>516897.263977</td>\n",
       "      <td>0.527320</td>\n",
       "      <td>3587.134238</td>\n",
       "      <td>745.340029</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>135 rows × 228 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "entity            Afghanistan  Albania   Algeria  American Samoa  \\\n",
       "year age_group                                                     \n",
       "1990 15-49         414.709676      0.0  3.499560        0.071837   \n",
       "     5-14           53.352844      0.0  0.124682        0.000602   \n",
       "     50-69          60.541746      0.0  0.771225        0.026402   \n",
       "     70 or older    10.728850      0.0  0.329148        0.007296   \n",
       "     Under 5       184.606435      0.0  0.633437        0.000942   \n",
       "...                       ...      ...       ...             ...   \n",
       "2016 15-49        1325.554673      0.0  5.119187        0.077682   \n",
       "     5-14          186.455122      0.0  0.094867        0.000565   \n",
       "     50-69         188.921260      0.0  1.726747        0.040865   \n",
       "     70 or older    35.423502      0.0  0.790427        0.006043   \n",
       "     Under 5       409.785603      0.0  0.284843        0.000471   \n",
       "\n",
       "entity            Andean Latin America  Andorra       Angola  \\\n",
       "year age_group                                                 \n",
       "1990 15-49                   40.859972      0.0   207.899777   \n",
       "     5-14                    26.399371      0.0   229.748378   \n",
       "     50-69                   13.458133      0.0   125.521504   \n",
       "     70 or older              8.512362      0.0    65.237773   \n",
       "     Under 5                 43.893407      0.0  2155.637127   \n",
       "...                                ...      ...          ...   \n",
       "2016 15-49                   10.556593      0.0   847.451177   \n",
       "     5-14                     1.892259      0.0   574.935652   \n",
       "     50-69                    5.722080      0.0   493.088315   \n",
       "     70 or older              4.174871      0.0   295.787678   \n",
       "     Under 5                  3.682405      0.0  5510.827146   \n",
       "\n",
       "entity            Antigua and Barbuda  Argentina   Armenia  ...    Vanuatu  \\\n",
       "year age_group                                              ...              \n",
       "1990 15-49                        0.0   4.065996  0.568197  ...  24.294096   \n",
       "     5-14                         0.0   0.184367  0.035616  ...   2.169473   \n",
       "     50-69                        0.0   2.518110  0.273035  ...   7.818126   \n",
       "     70 or older                  0.0   2.329918  0.174232  ...   2.034979   \n",
       "     Under 5                      0.0   0.152748  0.048349  ...  50.577984   \n",
       "...                               ...        ...       ...  ...        ...   \n",
       "2016 15-49                        0.0   0.994254  0.000000  ...   2.383817   \n",
       "     5-14                         0.0   0.027874  0.000000  ...   0.016351   \n",
       "     50-69                        0.0   0.625112  0.000000  ...   2.937429   \n",
       "     70 or older                  0.0   0.764052  0.000000  ...   0.783829   \n",
       "     Under 5                      0.0   0.015501  0.000000  ...   0.021150   \n",
       "\n",
       "entity            Venezuela     Vietnam  Wales  Western Europe  \\\n",
       "year age_group                                                   \n",
       "1990 15-49        12.526649  494.239483    0.0             0.0   \n",
       "     5-14          3.104614  114.558962    0.0             0.0   \n",
       "     50-69         3.858881  157.004672    0.0             0.0   \n",
       "     70 or older   1.558702   75.116583    0.0             0.0   \n",
       "     Under 5       6.793810  241.306740    0.0             0.0   \n",
       "...                     ...         ...    ...             ...   \n",
       "2016 15-49        10.920133  550.367934    0.0             0.0   \n",
       "     5-14          1.184906   48.886247    0.0             0.0   \n",
       "     50-69         3.779178  279.487378    0.0             0.0   \n",
       "     70 or older   1.737585  152.587626    0.0             0.0   \n",
       "     Under 5       2.173018   96.689580    0.0             0.0   \n",
       "\n",
       "entity            Western Sub-Saharan Africa          World     Yemen  \\\n",
       "year age_group                                                          \n",
       "1990 15-49                      11329.442132   48275.169475  2.340752   \n",
       "     5-14                       22390.602195   68752.585590  0.105084   \n",
       "     50-69                       9695.252559   27720.578684  0.436791   \n",
       "     70 or older                 6163.091793   15103.452338  0.148370   \n",
       "     Under 5                   288512.048844  586161.122620  1.045693   \n",
       "...                                      ...            ...       ...   \n",
       "2016 15-49                      27308.825303   69181.523171  4.976979   \n",
       "     5-14                       35949.278660   66900.805566  0.148588   \n",
       "     50-69                      17718.223791   40516.069944  1.048979   \n",
       "     70 or older                12048.574328   26055.802074  0.292241   \n",
       "     Under 5                   353171.602621  516897.263977  0.527320   \n",
       "\n",
       "entity                 Zambia    Zimbabwe  \n",
       "year age_group                             \n",
       "1990 15-49         351.092094  146.071799  \n",
       "     5-14          605.567382   72.520402  \n",
       "     50-69         205.413588   40.454584  \n",
       "     70 or older   119.232947   24.646719  \n",
       "     Under 5      6997.750038  260.447881  \n",
       "...                       ...         ...  \n",
       "2016 15-49         605.018912  453.902190  \n",
       "     5-14          443.313028  177.953936  \n",
       "     50-69         324.302931   97.402058  \n",
       "     70 or older   247.774196   66.572213  \n",
       "     Under 5      3587.134238  745.340029  \n",
       "\n",
       "[135 rows x 228 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.stack()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age_group</th>\n",
       "      <th>15-49</th>\n",
       "      <th>5-14</th>\n",
       "      <th>50-69</th>\n",
       "      <th>70 or older</th>\n",
       "      <th>Under 5</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>year</th>\n",
       "      <th>entity</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1990</th>\n",
       "      <th>Afghanistan</th>\n",
       "      <td>414.709676</td>\n",
       "      <td>53.352844</td>\n",
       "      <td>60.541746</td>\n",
       "      <td>10.728850</td>\n",
       "      <td>184.606435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Albania</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Algeria</th>\n",
       "      <td>3.499560</td>\n",
       "      <td>0.124682</td>\n",
       "      <td>0.771225</td>\n",
       "      <td>0.329148</td>\n",
       "      <td>0.633437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>American Samoa</th>\n",
       "      <td>0.071837</td>\n",
       "      <td>0.000602</td>\n",
       "      <td>0.026402</td>\n",
       "      <td>0.007296</td>\n",
       "      <td>0.000942</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Andean Latin America</th>\n",
       "      <td>40.859972</td>\n",
       "      <td>26.399371</td>\n",
       "      <td>13.458133</td>\n",
       "      <td>8.512362</td>\n",
       "      <td>43.893407</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">2016</th>\n",
       "      <th>Western Sub-Saharan Africa</th>\n",
       "      <td>27308.825303</td>\n",
       "      <td>35949.278660</td>\n",
       "      <td>17718.223791</td>\n",
       "      <td>12048.574328</td>\n",
       "      <td>353171.602621</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>World</th>\n",
       "      <td>69181.523171</td>\n",
       "      <td>66900.805566</td>\n",
       "      <td>40516.069944</td>\n",
       "      <td>26055.802074</td>\n",
       "      <td>516897.263977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Yemen</th>\n",
       "      <td>4.976979</td>\n",
       "      <td>0.148588</td>\n",
       "      <td>1.048979</td>\n",
       "      <td>0.292241</td>\n",
       "      <td>0.527320</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zambia</th>\n",
       "      <td>605.018912</td>\n",
       "      <td>443.313028</td>\n",
       "      <td>324.302931</td>\n",
       "      <td>247.774196</td>\n",
       "      <td>3587.134238</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zimbabwe</th>\n",
       "      <td>453.902190</td>\n",
       "      <td>177.953936</td>\n",
       "      <td>97.402058</td>\n",
       "      <td>66.572213</td>\n",
       "      <td>745.340029</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6156 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "age_group                               15-49          5-14         50-69  \\\n",
       "year entity                                                                 \n",
       "1990 Afghanistan                   414.709676     53.352844     60.541746   \n",
       "     Albania                         0.000000      0.000000      0.000000   \n",
       "     Algeria                         3.499560      0.124682      0.771225   \n",
       "     American Samoa                  0.071837      0.000602      0.026402   \n",
       "     Andean Latin America           40.859972     26.399371     13.458133   \n",
       "...                                       ...           ...           ...   \n",
       "2016 Western Sub-Saharan Africa  27308.825303  35949.278660  17718.223791   \n",
       "     World                       69181.523171  66900.805566  40516.069944   \n",
       "     Yemen                           4.976979      0.148588      1.048979   \n",
       "     Zambia                        605.018912    443.313028    324.302931   \n",
       "     Zimbabwe                      453.902190    177.953936     97.402058   \n",
       "\n",
       "age_group                         70 or older        Under 5  \n",
       "year entity                                                   \n",
       "1990 Afghanistan                    10.728850     184.606435  \n",
       "     Albania                         0.000000       0.000000  \n",
       "     Algeria                         0.329148       0.633437  \n",
       "     American Samoa                  0.007296       0.000942  \n",
       "     Andean Latin America            8.512362      43.893407  \n",
       "...                                       ...            ...  \n",
       "2016 Western Sub-Saharan Africa  12048.574328  353171.602621  \n",
       "     World                       26055.802074  516897.263977  \n",
       "     Yemen                           0.292241       0.527320  \n",
       "     Zambia                        247.774196    3587.134238  \n",
       "     Zimbabwe                       66.572213     745.340029  \n",
       "\n",
       "[6156 rows x 5 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.stack(level='entity')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
